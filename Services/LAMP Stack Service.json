{
  "service": {
    "version": "5.0.1.0",
    "specVersion": "v3",
    "catalog_metadata": {
      "name": "LAMP Stack Service",
      "description": "Service deploys VM on selected provider, installs LAMP stack, sends email at the end of deployment. ",
      "image": "serviceicon_1.svg",
      "category": "Integration Services",
      "bullets": [
        {
          "title": "Approval requested for deployment",
          "description": "Approval will be sent to the Infrastructure Management - Service Requests dashboard.  The process will not start until that has been approved."
        },
        {
          "title": "Create VM with LAMP Stack on IBMCloud or AWS",
          "description": "Deploy's you choice of IBMCloud or AWS VM and then installs the LAMP Stack onto that VM.   Get your development or test environment ready in minutes."
        },
        {
          "title": "Able to redeploy Lamp Stack day 2",
          "description": "Update your application stack as needed by rerunning the ansible-playbook for Lamp install and config.  This can enable LAMP stack upgrades"
        }
      ],
      "providerDisplayName": "IBM",
      "longDescription": "Service deploys VM on the selected provider, installs LAMP stack, sends an email at the end of the deployment. \n** Contains an Approval Flow that must be manually Approved in the Infrastructure Management Service Requests page.",
      "documentationUrl": "",
      "supportUrl": "",
      "bindable": false,
      "updatable": "",
      "systemTags": true
    },
    "tags": [
      {
        "name": "environment",
        "label": "Environment",
        "type": "string",
        "immutable": false,
        "hidden": false,
        "required": true,
        "secured": false,
        "description": "Unique identifer added to the provisioned VMs.",
        "isSystemTag": true,
        "customtype": "string",
        "permission": "Read-Write",
        "options": [
          {
            "label": "Development",
            "value": "dev",
            "default": true
          },
          {
            "label": "Quality Assurance",
            "value": "qa",
            "default": false
          },
          {
            "label": "Production",
            "value": "prod",
            "default": false
          },
          {
            "label": "Test",
            "value": "test",
            "default": false
          }
        ]
      },
      {
        "name": "Name",
        "label": "Name",
        "type": "string",
        "immutable": true,
        "hidden": false,
        "required": false,
        "secured": false,
        "description": "Name provided for the service instance by the end user at time of request",
        "isSystemTag": true,
        "customtype": "string",
        "permission": "Read-Only",
        "default": "${svc_instance.name}"
      },
      {
        "name": "request_group",
        "label": "request_group",
        "type": "string",
        "immutable": true,
        "hidden": false,
        "required": false,
        "secured": false,
        "description": "The current context group id of the current user that requested the provisioning of the template. This is important because a user may be part of more than one group and this identifies the context of which group the user made the request.",
        "isSystemTag": true,
        "customtype": "string",
        "permission": "Read-Only",
        "default": "${svc_instance.group}"
      },
      {
        "name": "request_user",
        "label": "request_user",
        "type": "string",
        "immutable": true,
        "hidden": false,
        "required": false,
        "secured": false,
        "description": "The user id of the current user that requested the provisioning of the template.",
        "isSystemTag": true,
        "customtype": "string",
        "permission": "Read-Only",
        "default": "${svc_instance.owner}"
      },
      {
        "name": "service_name",
        "label": "service_name",
        "type": "string",
        "immutable": true,
        "hidden": false,
        "required": false,
        "secured": false,
        "description": "Name provided for the service instance by the end user at time of request",
        "isSystemTag": true,
        "customtype": "string",
        "permission": "Read-Only",
        "default": "${svc_instance.name}"
      },
      {
        "name": "service_identifier",
        "label": "service_identifier",
        "type": "string",
        "immutable": true,
        "hidden": false,
        "required": false,
        "secured": false,
        "description": "Unique identifer generated by ICAM which is mapped to the service instance of the template provisioned.",
        "isSystemTag": true,
        "customtype": "string",
        "permission": "Read-Only",
        "default": "${svc_instance.service_instance_id}"
      },
      {
        "name": "Review_freq",
        "label": "Retirement Review",
        "type": "string",
        "immutable": false,
        "hidden": false,
        "required": true,
        "secured": false,
        "description": "How often will the system be reviewed for retirement",
        "permission": "Read-Write",
        "isSystemTag": false,
        "options": [
          {
            "label": "Weekly",
            "value": "weekly",
            "default": true
          },
          {
            "label": "Quarterly",
            "value": "quarter",
            "default": false
          }
        ],
        "customtype": "string"
      },
      {
        "name": "team",
        "label": "",
        "type": "string",
        "immutable": true,
        "hidden": true,
        "required": false,
        "secured": false,
        "description": "",
        "permission": "Invisible",
        "isSystemTag": false,
        "default": "ICPMCM",
        "customtype": "string"
      }
    ],
    "upgrade_from": [],
    "downgrade_to": [],
    "actions": [
      {
        "type": "provision",
        "name": "Provision",
        "description": "Default action for deployment of service",
        "input_parameters": [
          {
            "name": "Connection",
            "label": "cloud connection",
            "customtype": "connection",
            "type": "connection",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "",
            "view": "create new",
            "editable": true,
            "default": "",
            "provider": "Amazon EC2"
          },
          {
            "name": "ssh-key-name",
            "label": "SSH Key Name",
            "customtype": "string",
            "type": "string",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "SSH Key Name",
            "default": "lamp-key1",
            "editable": true,
            "passbyname": false,
            "dynamicDetails": {},
            "isDynamic": false
          },
          {
            "name": "credential_name_suffix",
            "label": "Ansible Credential Suffix",
            "customtype": "string",
            "type": "string",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "",
            "view": "create new",
            "editable": true,
            "default": "ans-cred1"
          },
          {
            "name": "inventory_name",
            "label": "Ansible Inventory Suffix",
            "customtype": "string",
            "type": "string",
            "immutable": false,
            "hidden": false,
            "required": false,
            "secured": false,
            "isDynamic": false,
            "editable": true,
            "default": "ans-inv1",
            "passbyname": false,
            "dynamicDetails": {}
          },
          {
            "name": "cloud_provider",
            "label": "Cloud Provider",
            "customtype": "string",
            "type": "string",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "",
            "view": "create new",
            "editable": true,
            "options": [
              {
                "value": "AWS",
                "label": "AWS"
              },
              {
                "value": "IBMCloud",
                "label": "IBMCloud"
              }
            ],
            "passbyname": false,
            "dynamicDetails": {},
            "isDynamic": false
          },
          {
            "name": "user_name",
            "label": "User Name",
            "customtype": "string",
            "type": "string",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "",
            "view": "create new",
            "editable": true,
            "default": ""
          },
          {
            "name": "aws_image_size",
            "label": "AWS Image Instance Size",
            "customtype": "string",
            "type": "string",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "AWS Image Instance Size",
            "view": "create new",
            "editable": true,
            "default": "t2.small"
          },
          {
            "name": "approval_req_url",
            "customtype": "string",
            "type": "string",
            "immutable": true,
            "hidden": true,
            "required": false,
            "secured": false,
            "isDynamic": false,
            "editable": false,
            "default": "https://inframgmtinstall.apps.purple-20d.dev.multicloudops.io/api/service_catalogs/3/service_templates"
          },
          {
            "name": "payload",
            "label": "",
            "customtype": "string",
            "type": "string",
            "immutable": true,
            "hidden": true,
            "required": false,
            "secured": false,
            "description": "",
            "isDynamic": false,
            "editable": false,
            "default": "{\"action\":\"order\",\"resource\":{\"href\":\"https://inframgmtinstall.apps.purple-20d.dev.multicloudops.io/api/service_catalogs/3/service_templates/2\"}}"
          },
          {
            "name": "curl_option",
            "label": "CURL Option",
            "customtype": "string",
            "type": "string",
            "immutable": true,
            "hidden": true,
            "required": false,
            "secured": false,
            "description": "Options for curl command used to retrieve status from Infrastructure Management e.g. --insecure",
            "view": "create new",
            "editable": true,
            "default": "--insecure",
            "passbyname": false,
            "dynamicDetails": {},
            "isDynamic": false
          },
          {
            "name": "wait_time",
            "label": "Approval Wait Time",
            "customtype": "string",
            "type": "string",
            "immutable": true,
            "hidden": true,
            "required": true,
            "secured": false,
            "description": "Wait time in seconds i.e. time after which poll should again happen to retrieve the approval status",
            "view": "create new",
            "editable": true,
            "default": "5",
            "passbyname": false,
            "dynamicDetails": {},
            "isDynamic": false
          }
        ],
        "flow": {
          "conditions": [
            {
              "decision": {
                "title": "decision_785ea8",
                "options": [
                  {
                    "case": "AWS",
                    "sequence": {
                      "0": "amazonec9b6a5633",
                      "1": "inventor7dafa2b7"
                    }
                  },
                  {
                    "case": "IBMCloud",
                    "sequence": {
                      "0": "virtualm678859dd",
                      "1": "inventor349e9ecb"
                    }
                  }
                ],
                "id": "decision9b758e1f",
                "editable": true,
                "mapped_parameter": "${input_parameters.cloud_provider}",
                "isErrorFlow": false
              }
            }
          ],
          "templates": [
            {
              "Poll Infrastructure Management for Approval": {
                "title": "Wait_on_Approval",
                "template_name": "Poll Infrastructure Management for Approval",
                "version": "2.4",
                "id": "pollinfra611594e",
                "template_type": "Terraform",
                "template_content_type": "Other",
                "template_provider": "Other",
                "instance_name": "",
                "template_data_objects": {
                  "im_auth": "im_cp_auth"
                },
                "template_params": {
                  "url": "${resthooks.resthookdd0e5a09.body.results[0].href}",
                  "username": "${im_auth.username}",
                  "password": "${im_auth.password}",
                  "curl_option": "${input_parameters.curl_option}",
                  "wait_time": "${input_parameters.wait_time}"
                },
                "outputs": [
                  "approval_status"
                ],
                "editable": true,
                "cloud_connection_names": [
                  {
                    "provider": "Other",
                    "connection_name": "Other"
                  }
                ],
                "provider_engine_version": "0.12.21",
                "isErrorFlow": false,
                "cloud_connection_name": "Other"
              }
            },
            {
              "Amazon EC2 Virtual Server with SSH key": {
                "title": "Create_Amazon_EC2_VM",
                "template_name": "Amazon EC2 Virtual Server with SSH key",
                "version": "2.4",
                "id": "amazonec9b6a5633",
                "template_type": "Terraform",
                "template_content_type": "Amazon EC2",
                "template_provider": "Amazon EC2",
                "instance_name": "",
                "template_data_objects": {},
                "template_params": {
                  "aws_region": "us-east-1",
                  "aws_image": "ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-*",
                  "aws_image_size": "${input_parameters.aws_image_size}",
                  "aws_ami_owner_id": "099720109477",
                  "vpc_name_tag": "CAMVPC",
                  "subnet_name": "CAM",
                  "public_ssh_key_name": "${input_parameters.ssh-key-name}",
                  "public_ssh_key": "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDNMFHlQHsu8y9y7OLZ4pCxXWIY7Wh+g5KjaxsyBqnH1hh0RA4sEJ881tXOxcQ7vafxFA6TxnHGJlp3LFjb1gzEEIOC8NHEYLh9FJ5OdO3kInTFmHVd/KN2Iw2ycnJv/nDG8KcYxmxX2LcPZDyd6ekoiNUTXOUWHum3mqgkcsmpfdVRgOhY0DCRlDT7Z8trrAoxR1MrGx3e5mQbwNLPm0V0mwwiXlHTt2yaPFFFqTQQvRPbVLbl8AsX6B2wrwssphoi+lPmOjKULvf/Q0wE6G1ACeG39y2Qaag9vc1hsWdZWPf55tHekzjQmlixP2C7uMRejclPoBBz0D17Zbdouw/x root@dockercompose-1.fyre.ibm.com"
                },
                "outputs": [
                  "ip_address"
                ],
                "editable": true,
                "cloud_connection_names": [
                  {
                    "provider": "Amazon EC2",
                    "connection_name": "${input_parameters.Connection}"
                  }
                ],
                "provider_engine_version": "0.11.11",
                "isErrorFlow": false
              }
            },
            {
              "Inventory": {
                "title": "Add_vm_to_ansibleTW_AWS",
                "template_name": "Inventory",
                "version": "1.0",
                "id": "inventor7dafa2b7",
                "template_type": "ANSIBLE",
                "template_content_type": "ANSIBLE",
                "template_provider": "ANSIBLE",
                "instance_name": "",
                "cloud_connection_name": "ansible-connection",
                "template_data_objects": {},
                "template_params": {
                  "organizationName": "Default",
                  "inventoryName": "${input_parameters.inventory_name}",
                  "extraVars": {},
                  "hostgroup": {
                    "None": "${templates.amazonec9b6a5633.output.ip_address}"
                  }
                },
                "outputs": [
                  "inventory_name"
                ],
                "editable": true,
                "provider_engine_version": "1.0",
                "isErrorFlow": false
              }
            },
            {
              "Virtual Machine Ubuntu with SSH Key": {
                "title": "Create_IBMCloud_VM",
                "template_name": "Virtual Machine Ubuntu with SSH Key",
                "version": "v1.0.0",
                "id": "virtualm678859dd",
                "template_type": "Terraform",
                "template_content_type": "IBM",
                "template_provider": "IBM",
                "instance_name": "",
                "template_data_objects": {},
                "template_params": {
                  "datacenter": "dal09",
                  "domain": "sample.com",
                  "hostname": "debian-small",
                  "os": "UBUNTU_16_64",
                  "public_ssh_key": "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDNMFHlQHsu8y9y7OLZ4pCxXWIY7Wh+g5KjaxsyBqnH1hh0RA4sEJ881tXOxcQ7vafxFA6TxnHGJlp3LFjb1gzEEIOC8NHEYLh9FJ5OdO3kInTFmHVd/KN2Iw2ycnJv/nDG8KcYxmxX2LcPZDyd6ekoiNUTXOUWHum3mqgkcsmpfdVRgOhY0DCRlDT7Z8trrAoxR1MrGx3e5mQbwNLPm0V0mwwiXlHTt2yaPFFFqTQQvRPbVLbl8AsX6B2wrwssphoi+lPmOjKULvf/Q0wE6G1ACeG39y2Qaag9vc1hsWdZWPf55tHekzjQmlixP2C7uMRejclPoBBz0D17Zbdouw/x root@dockercompose-1.fyre.ibm.com"
                },
                "outputs": [
                  "vm_ip"
                ],
                "editable": true,
                "cloud_connection_names": [
                  {
                    "provider": "IBM",
                    "connection_name": "${input_parameters.Connection}"
                  }
                ],
                "provider_engine_version": "0.11.11",
                "cloud_connection_name": "ibm-cloud"
              }
            },
            {
              "Inventory": {
                "title": "Add_vm_to_ansibleTW_IBMC",
                "template_name": "Inventory",
                "version": "1.0",
                "id": "inventor349e9ecb",
                "template_type": "ANSIBLE",
                "template_content_type": "ANSIBLE",
                "template_provider": "ANSIBLE",
                "instance_name": "",
                "cloud_connection_name": "ansible-connection",
                "template_data_objects": {},
                "template_params": {
                  "organizationName": "Default",
                  "inventoryName": "${input_parameters.inventory_name}",
                  "extraVars": {},
                  "hostgroup": {
                    "None": "${templates.virtualm678859dd.output.vm_ip}"
                  }
                },
                "outputs": [
                  "inventory_name"
                ],
                "editable": true,
                "provider_engine_version": "1.0",
                "isErrorFlow": false
              }
            },
            {
              "Credential": {
                "title": "Add_cred_to_ansibleTW",
                "template_name": "Credential",
                "version": "1.0",
                "id": "credenti002072a4",
                "template_type": "ANSIBLE",
                "template_content_type": "ANSIBLE",
                "template_provider": "ANSIBLE",
                "instance_name": "",
                "cloud_connection_name": "ansible-connection",
                "template_data_objects": {},
                "template_params": {
                  "credential_name_suffix": "${input_parameters.credential_name_suffix}",
                  "user_name": "${input_parameters.user_name}",
                  "ssh_private_key": "-----BEGIN RSA PRIVATE KEY-----\nMIIEpAIBAAKCAQEAzTBR5UB7LvMvcuzi2eKQsV1iGO1ofoOSo2sbMgapx9YYdEQO\nLBCfPNbVzsXEO72n8RQOk8ZxxiZadyxY29YMxBCDgvDRxGC4fRSeTnTt5CJ0xZh1\nXfyjdiMNsnJyb/5wxvCnGMZsV9i3D2Q8nenpKIjVE1zlFh7pt5qoJHLJqX3VUYDo\nWNAwkZQ0+2fLa6wKMUdTKxsd3uZkG8DSz5tFdJsMIl5R07dsmjxRRak0EL0T21S2\n5fALF+gdsK8LLKYaIvpT5joylC73/0NMBOhtQAnht/ctkGmoPb3NYbFnWVj3+ebR\n3pM40JpYsT9gu7jEXo3JT6AQc9A9e2W3aLsP8QIDAQABAoIBAAKLn+h1JVIOyD7n\nu2Syj9Lzcp0WjN5M6YvHb13ugTquaD1A/uADEMajb6GSCH4pOyUdd5TTuGOZ5DNo\nRG3tuNjRz5/XNvL1tDQxBkm4356d4s70tjgFQ03a33egPdUv1dxR7fC7vWpVkOfK\n+YmH9lF/aQ1FcL4WghW6AG37Uo8cr89LKcGqJbg/gMkoxCM2WreSHdAca/7sEMcK\nhLIxa9D248V8XixdDuyHkEb8BVapIKhrOLJzN6soNbAiQovpWDmqtEHMjTbLjoG/\n+3ZYoPyXfkCrE5hVJXlXfnph87uH+EsNSGz7zD3x3WlRKuJzZAfm6r7GB5Qx45QS\nbhzm+tUCgYEA87p3P+txYIEEfDXKGLfJETEe5vrTonzD/W4Z8EEjOFSaouL0atvh\nT+4XxXtEmLR4lTjYlgsqRK3frHc6saphwkFecBJQvX+XViKyDV4T4JYE8DOOHzqI\nt4vQ/1XoDs7qwXG4sauHVlm0g4l7RW8h8zIdXYIZtVZqVLng4aKTU9cCgYEA14UZ\nEkg+ktpU0/VN8G0yqQs7Md0TfhvlaIi3qBRB43Bjrrf4VjTZzNJnrU9+o/Zp3Y6v\navSesTL3fMRVl3yiIqmU/IuMkA0beSUmv1XgaQNLhriTzBTHft5VZx46quNSPmWt\nMCytqd3Ut3/AQ7lztqGXk+Pz0wO+xxNixPsGwXcCgYEAzRp65eiNZafNDXX6l2h6\nJSSQG9KyrIeQK0IvQ9ac+/d+llqlUxOsfSYhDQgaBuPAodrPsRy+OkOT+j/vvblj\nQSTfgzJ2jbHEujDCY6tq0NGOYFESZcdNbCCWBXnWqjeIqLe5tJJjdtBQr2zPtvO5\nvz3KJnmohsis/JXb4CV/E8sCgYAiDXqno9iXNX4fu2ukKGzPvuGMgGTbESdPPALg\nwMqkWBa3/YN0g4dCUKBnBt94oq+ZfTkESkBkuSvXf+ISPHQVy/upZ5c/D4Mewhr8\nMmJx1T5yu+lGXqYiypht4Z3dcGuHRmN18ClEZLN+huXnDX9WBPRBPsxAtB/Jrqt1\nekBYAwKBgQDhA1HhMH17RCfwf5Rancxe6xJSGSecEbUAcNOOu5XnRY6vdmOy8Tm8\n34MCxKPk4FshiL02SU6X1SCGFXaEqyTR25AYElB0M9nCAkZnPaa56GfJzojhM20j\nklHcm2sACye2BlbBAQ7Qdk97bHtzZYT0ojWaS4bci1k5sQBFncPmSw==\n-----END RSA PRIVATE KEY-----",
                  "password": ""
                },
                "outputs": [
                  "credential_name"
                ],
                "editable": true,
                "isErrorFlow": false
              }
            },
            {
              "LAMP Stack": {
                "title": "Install_LAMP_Stack_Playbook",
                "template_name": "LAMP Stack",
                "version": "1.0",
                "id": "lampstacab341129",
                "template_type": "ANSIBLE",
                "template_content_type": "ANSIBLE",
                "template_provider": "ANSIBLE",
                "instance_name": "",
                "cloud_connection_name": "ansible-connection",
                "template_data_objects": {},
                "template_params": {
                  "inventory_name": "${templates.inventor7dafa2b7.output.inventory_name||templates.inventor349e9ecb.output.inventory_name}",
                  "credential_name": "${templates.credenti002072a4.output.credential_name}",
                  "extra_variables": {}
                },
                "outputs": [
                  "job_status"
                ],
                "editable": true,
                "isErrorFlow": false
              }
            }
          ],
          "resthooks": [
            {
              "resthook": {
                "title": "RH_Submit_Approval",
                "id": "resthookdd0e5a09",
                "headers": {
                  "accept": "application/json",
                  "Content-Type": "application/json"
                },
                "editable": true,
                "url": "${input_parameters.approval_req_url}",
                "method": "POST",
                "payload": "${input_parameters.payload}",
                "auth": {
                  "type": "basic",
                  "username": "admin",
                  "password": "^(c21hcnR2bQ==)"
                },
                "isErrorFlow": false
              }
            },
            {
              "resthook": {
                "title": "SendSlackNotification",
                "id": "resthook40749fa1",
                "headers": {
                  "accept": "application/json",
                  "Content-Type": "application/json"
                },
                "editable": true,
                "url": "https://hooks.slack.com/services/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",
                "method": "POST",
                "payload": {
                  "blocks": [
                    {
                      "type": "section",
                      "text": {
                        "type": "mrkdwn",
                        "text": "*APPROVAL REQUEST RECEIVED*@here\n:cp4mcm: Approval Request Submitted for the deployment of the service: * ${svc_instance.name}* \n*<https://inframgmtinstall.apps.purple-20d.dev.multicloudops.io/miq_request/show_list?typ=service#/|Take Action :bitmojiyesorno:>*"
                      }
                    }
                  ]
                }
              }
            }
          ],
          "notifications": [],
          "sequence": {
            "0": "resthookdd0e5a09",
            "1": "resthook40749fa1",
            "2": "pollinfra611594e",
            "3": "decision9b758e1f",
            "4": "credenti002072a4",
            "5": "lampstacab341129"
          },
          "error_sequence": {}
        },
        "output_parameters": [
          {
            "name": "Lamp_URI",
            "label": "Lamp URI",
            "customtype": "string",
            "type": "string",
            "immutable": true,
            "hidden": false,
            "required": false,
            "secured": false,
            "description": "uri to lamp server",
            "default": "http://${templates.amazonec9b6a5633.output.ip_address||templates.virtualm678859dd.output.vm_ip}",
            "editable": true
          },
          {
            "name": "ans_inv_name",
            "label": "Ansible Inventory Name",
            "customtype": "string",
            "type": "string",
            "immutable": true,
            "hidden": false,
            "required": false,
            "secured": false,
            "default": "${templates.inventor7dafa2b7.output.inventory_name||templates.inventor349e9ecb.output.inventory_name}",
            "editable": true
          },
          {
            "name": "ans_cred_name",
            "label": "Ansible Credential Name",
            "customtype": "string",
            "type": "string",
            "immutable": true,
            "hidden": false,
            "required": false,
            "secured": false,
            "description": "",
            "default": "${templates.credenti002072a4.output.credential_name}"
          }
        ]
      },
      {
        "type": "custom",
        "name": "Update Lamp Stack",
        "description": "Update Lamp Stack using Ansible Playbook",
        "input_parameters": [
          {
            "customtype": "sharedparameter",
            "type": "sharedparameter",
            "immutable": true,
            "hidden": true,
            "required": true,
            "secured": false,
            "description": "",
            "default": "im_cp_auth",
            "datatype": "im_auth",
            "name": "ims_cred_2",
            "label": "IM_Creds",
            "passbyname": false,
            "dynamicDetails": {},
            "isDynamic": false
          }
        ],
        "flow": {
          "conditions": [],
          "templates": [
            {
              "LAMP Stack Update Plus": {
                "title": "LAMP Stack Update Plus",
                "template_name": "LAMP Stack Update Plus",
                "version": "1.0",
                "id": "lampstac55586a63",
                "template_type": "ANSIBLE",
                "template_content_type": "ANSIBLE",
                "template_provider": "ANSIBLE",
                "instance_name": "${svc_instance.name}_upgrade",
                "cloud_connection_name": "ansible-connection",
                "template_data_objects": {},
                "template_params": {
                  "inventory_name": "${svc_instance.output_parameters.ans_inv_name}",
                  "credential_name": "${svc_instance.output_parameters.ans_cred_name}",
                  "extra_variables": {}
                },
                "outputs": [
                  "job_status"
                ],
                "editable": true
              }
            }
          ],
          "resthooks": [],
          "notifications": [],
          "sequence": {
            "0": "lampstac55586a63"
          },
          "error_sequence": {}
        },
        "output_parameters": [],
        "datatypes": [
          {
            "id": "",
            "description": "",
            "datatype": "",
            "default": "${input_parameters.}",
            "immutable": false
          }
        ]
      }
    ],
    "plans": [
      {
        "name": "Amazon EC2",
        "description": "Deploy LAMP stack on Amazon EC2",
        "actions": [],
        "plan_parameters": [
          {
            "name": "cloud_provider",
            "label": "Cloud Provider",
            "customtype": "string",
            "type": "string",
            "immutable": true,
            "hidden": true,
            "required": true,
            "secured": false,
            "description": "",
            "isDynamic": false,
            "editable": false,
            "default": "AWS"
          },
          {
            "name": "Connection",
            "label": "cloud connection",
            "customtype": "connection",
            "type": "connection",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "",
            "view": "create new",
            "editable": true,
            "default": "",
            "provider": "Amazon EC2"
          },
          {
            "name": "ssh-key-name",
            "label": "SSH Key Name",
            "customtype": "string",
            "type": "string",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "SSH Key Name",
            "default": "lamp-key1",
            "editable": true,
            "passbyname": false,
            "dynamicDetails": {},
            "isDynamic": false
          },
          {
            "name": "credential_name_suffix",
            "label": "Ansible Credential Suffix",
            "customtype": "string",
            "type": "string",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "",
            "view": "create new",
            "editable": true,
            "default": "ans-cred1"
          },
          {
            "name": "inventory_name",
            "label": "Ansible Inventory Suffix",
            "customtype": "string",
            "type": "string",
            "immutable": false,
            "hidden": false,
            "required": false,
            "secured": false,
            "isDynamic": false,
            "editable": true,
            "default": "ans-inv1",
            "passbyname": false,
            "dynamicDetails": {}
          },
          {
            "name": "user_name",
            "label": "User Name",
            "customtype": "string",
            "type": "string",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "",
            "view": "create new",
            "default": "ubuntu"
          },
          {
            "name": "aws_image_size",
            "label": "Instance Spec Size",
            "customtype": "string",
            "type": "string",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "AWS Image Instance Size",
            "options": [
              {
                "label": "1 CPU, 2Gb Mem",
                "value": "t2.small",
                "default": true
              },
              {
                "label": "1 CPU, 1 Gb Mem",
                "value": "t2.micro",
                "default": false
              }
            ]
          },
          {
            "name": "approval_req_url",
            "customtype": "string",
            "type": "string",
            "immutable": true,
            "hidden": true,
            "required": false,
            "secured": false,
            "isDynamic": false,
            "editable": false,
            "default": "https://inframgmtinstall.apps.purple-20d.dev.multicloudops.io/api/service_catalogs/3/service_templates"
          },
          {
            "name": "payload",
            "label": "",
            "customtype": "string",
            "type": "string",
            "immutable": true,
            "hidden": true,
            "required": false,
            "secured": false,
            "description": "",
            "isDynamic": false,
            "editable": false,
            "default": "{\"action\":\"order\",\"resource\":{\"href\":\"https://inframgmtinstall.apps.purple-20d.dev.multicloudops.io/api/service_catalogs/3/service_templates/2\"}}"
          },
          {
            "name": "curl_option",
            "label": "CURL Option",
            "customtype": "string",
            "type": "string",
            "immutable": true,
            "hidden": true,
            "required": false,
            "secured": false,
            "description": "Options for curl command used to retrieve status from Infrastructure Management e.g. --insecure",
            "view": "create new",
            "editable": true,
            "default": "--insecure",
            "passbyname": false,
            "dynamicDetails": {},
            "isDynamic": false
          },
          {
            "name": "wait_time",
            "label": "Approval Wait Time",
            "customtype": "string",
            "type": "string",
            "immutable": true,
            "hidden": true,
            "required": true,
            "secured": false,
            "description": "Wait time in seconds i.e. time after which poll should again happen to retrieve the approval status",
            "view": "create new",
            "editable": true,
            "default": "5",
            "passbyname": false,
            "dynamicDetails": {},
            "isDynamic": false
          }
        ]
      },
      {
        "name": "IBM Cloud",
        "description": "Deploy LAMP stack on IBM Cloud",
        "plan_parameters": [
          {
            "name": "Connection",
            "label": "cloud connection",
            "customtype": "connection",
            "type": "connection",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "",
            "default": "ibm-cloud",
            "provider": "IBM"
          },
          {
            "name": "cloud_provider",
            "label": "Cloud Provider",
            "customtype": "string",
            "type": "string",
            "immutable": true,
            "hidden": true,
            "required": true,
            "secured": false,
            "description": "",
            "isDynamic": false,
            "default": "IBMCloud"
          },
          {
            "name": "ssh-key-name",
            "label": "SSH Key Name",
            "customtype": "string",
            "type": "string",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "SSH Key Name",
            "default": "lamp-key1",
            "editable": true,
            "passbyname": false,
            "dynamicDetails": {},
            "isDynamic": false
          },
          {
            "name": "credential_name_suffix",
            "label": "Ansible Credential Suffix",
            "customtype": "string",
            "type": "string",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "",
            "view": "create new",
            "editable": true,
            "default": "ans-cred1"
          },
          {
            "name": "inventory_name",
            "label": "Ansible Inventory Suffix",
            "customtype": "string",
            "type": "string",
            "immutable": false,
            "hidden": false,
            "required": false,
            "secured": false,
            "isDynamic": false,
            "editable": true,
            "default": "ans-inv1",
            "passbyname": false,
            "dynamicDetails": {}
          },
          {
            "name": "user_name",
            "label": "User Name",
            "customtype": "string",
            "type": "string",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "",
            "view": "create new",
            "default": "root"
          },
          {
            "name": "aws_image_size",
            "label": "AWS Image Instance Size",
            "customtype": "string",
            "type": "string",
            "immutable": true,
            "hidden": true,
            "required": true,
            "secured": false,
            "description": "AWS Image Instance Size",
            "editable": false,
            "default": "t2.small"
          },
          {
            "name": "approval_req_url",
            "customtype": "string",
            "type": "string",
            "immutable": true,
            "hidden": true,
            "required": false,
            "secured": false,
            "isDynamic": false,
            "editable": false,
            "default": "https://inframgmtinstall.apps.purple-20d.dev.multicloudops.io/api/service_catalogs/3/service_templates"
          },
          {
            "name": "payload",
            "label": "",
            "customtype": "string",
            "type": "string",
            "immutable": true,
            "hidden": true,
            "required": false,
            "secured": false,
            "description": "",
            "isDynamic": false,
            "editable": false,
            "default": "{\"action\":\"order\",\"resource\":{\"href\":\"https://inframgmtinstall.apps.purple-20d.dev.multicloudops.io/api/service_catalogs/3/service_templates/2\"}}"
          },
          {
            "name": "curl_option",
            "label": "CURL Option",
            "customtype": "string",
            "type": "string",
            "immutable": true,
            "hidden": true,
            "required": false,
            "secured": false,
            "description": "Options for curl command used to retrieve status from Infrastructure Management e.g. --insecure",
            "view": "create new",
            "editable": true,
            "default": "--insecure",
            "passbyname": false,
            "dynamicDetails": {},
            "isDynamic": false
          },
          {
            "name": "wait_time",
            "label": "Approval Wait Time",
            "customtype": "string",
            "type": "string",
            "immutable": true,
            "hidden": true,
            "required": true,
            "secured": false,
            "description": "Wait time in seconds i.e. time after which poll should again happen to retrieve the approval status",
            "view": "create new",
            "editable": true,
            "default": "5",
            "passbyname": false,
            "dynamicDetails": {},
            "isDynamic": false
          }
        ]
      }
    ]
  }
}